<ng-container>
    <div class="container mt-5 d-flex justify-content-center">
        <div class="detection-content">
            <ImageUploader [isEnabled]="true"
                           [title]="'detekcia'" 
                           (onUploadedTissue)="sentTissueForScan($event)" 
                           style="align-self: center;" />
            <div class="detection-score">
                <div class="detection-description">
                    <div class="row d-flex w-100 justify-content-center">
                        <div class="col-8 text-center"><span style="font-size: larger;">Tvoje <b>TILS</b></span></div>
                        <fa-icon class="w-auto" style="color: #6B6B6B;" (click)="openModal(templateTils)" id="results" [icon]="studyIcon"
                        size="2x"></fa-icon>
                    </div>
                    <div class="detection-tils-wrapper">
                        <div *ngIf="loading; else content" class="loading-spinner"></div>
                        <ng-template #content>
                            <h1>{{ detectionResult.tils }}</h1>
                        </ng-template>
                        <div class="row score-total">
                            <span>of 100</span>
                        </div>
                    </div>
                    <div class="detection-tils-message text-center">
                        <div class="row">
                            <h5 class="fw-bold">{{doctorAdvanceMessage()}}</h5>
                        </div>
                        <div class="row score-total py-4">
                            <p>Tvoje skóre je {{detectionResult.tils }}%</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="result-content">
                <div class="row mb-4">
                    <div class="detection-analyses-grid">
                        <div class="analyse-item grid-col-2 lymfo">
                            <div class="lymfo-content">
                                <div class="row mb-2"><span>Počet lymfocytov</span></div>
                                <div class="row align-items-center"><span>{{detectionResult.lymCount}}</span></div>
                            </div>
                        </div>
                        <div class="analyse-item grid-row-2 speed">
                            <div class="speed-content">
                                <div class="row mb-2"><span>Rýchlosť</span></div>
                                <div class="row text-center">
                                    <p class="fs-3" style="margin: 0;">{{detectionResult.executionTime | number:'1.2-2'}}</p>
                                    <p style="font-size: 0.6rem;">Sekúnd</p>
                                </div>
                                <div class="row text-end">
                                    <fa-icon [icon]="clockIcon" size="2x"></fa-icon>
                                </div>
                            </div>
                        </div>
                        <div class="analyse-item grid-row-2 mse">
                            <div class="mse-content">
                                <div class="row mb-2"><span>MSE</span></div>
                                <div class="row text-center">
                                    <p class="fs-3 fw-bold" style="margin: 0;">-%</p>
                                </div>
                            </div>
                        </div>
                        <div class="analyse-item total">
                            <div class="total-content">
                                <div class="row">
                                    <p>DICE</p>
                                    <p>-%</p>
                                </div>
                                <div class="row">
                                    <p>FROC</p>
                                    <p>-%</p>
                                </div>
                                <div class="row">
                                    <p>OTHERS</p>
                                    <p>-%</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row justify-content-center text-center">
                    <fa-icon class="w-auto" (click)="openModal(template)" id="results" [icon]="resultIcon"
                        size="7x"></fa-icon>
                </div>
            </div>
        </div>
    </div>
</ng-container>

<ng-template #template>
    <div class="modal-header">
        <h4 class="modal-title">Predikcia nálezov</h4>
        <button type="button" class="btn-close pull-right" (click)="modalRef.hide()">
            <span class="icon-cross"></span>
        </button>
    </div>
    <div class="modal-body d-flex justify-content-center">
        <div class="row">
            <div class="col-xl-6">
                <div class="image-box">
                    <img class="h-100" [src]="detectionResult.detectionOrigin ?? default_img" alt="Origin image">
                </div>
            </div>
            <div class="col-xl-6">
                <div class="image-box mx-2">
                    <img class="h-100" [src]="detectionResult.detectionPrediction ?? default_img" alt="Prediction image">
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-close-footer pull-right" (click)="modalRef.hide()">
            <b class="white-icon">Zatvoriť</b>
        </button>
    </div>
</ng-template>

<ng-template #templateTils>
    <div class="modal-header">
        <h4 class="modal-title">Ako funguje TILS?</h4>
        <button type="button" class="btn-close pull-right" (click)="modalRef.hide()">
            <span class="icon-cross"></span>
        </button>
    </div>
    <div class="modal-body d-flex justify-content-center">
        <div class="row">
            <img class="h-100" [src]="default_tils" alt="TILS">
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-close-footer pull-right" (click)="modalRef.hide()">
            <b class="white-icon">Zatvoriť</b>
        </button>
    </div>
</ng-template>